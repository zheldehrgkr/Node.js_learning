## Node.js에 대한 소개

### 특징

#### 자바스크립트 런타임

런타임은 프로그램 실행환경을 의미하는 것으로 원래 js는 웹 브라우저에서만 실행할 수 있었는데 컴퓨터에서도 js를 실행할 수 있게 되었다.
즉 Node.js는 자바스크립트 실행기라고 할 수 있으므로 당연히 js를 알아야 다룰 수 있다.

#### 이벤트 기반

Node.js는 이벤트 기반 모델이다.
그리고 당연히 js와 같은 방식으로 동작하고 이벤트 처리 방식이 중요하다고 설명하고 있다. (그리고 정말 그런 것 같다!)

- [ ] 여기도 설명이 잘 되어있기는 한데 js책으로 보충이 필요할 듯

예시 따라가면서 정리해 보았다.
콜스택 설명

```javascript
function first() {
  second();
  console.log("first");
}
function second() {
  third();
  console.log("second");
}
function third() {
  console.log("third");
}
first();
```

콜 스택은 말그대로 스택이므로 쌓인 스택의 맨 위부터 실행한다.  
first()가 호출되고 콜 스택에 쌓인다.  
first()가 실행된다.  
first()안의 second()가 호출되어 콜 스택에 쌓인다.  
second()가 실행된다.  
second()안의 third()가 호출되어 콜 스택에 쌓인다.  

이제 위에 쌓여있는 순서대로 실행하므로 third()가 실행되어 third 출력,  
third()가 팝되고 그 다음 쌓여 있는 second()가 실행되어 second 출력,  
second()가 팝되고 그 다음 쌓여 있는 first()가 실행되어 first 출력된다.  

이벤트 루프의 역할

```javascript
function run() {
  console.log("3초후 실행");
}
console.log("시작");
setTimeout(run, 3000);
console.log("끝");
```

3가지 공간이 있다.

- 콜 스택 : 실행함 함수가 쌓이는 곳, 스택이니 lifo방식으로 실행
- 백그라운드 : 비동기 함수의 콜백 함수나 이벤트 핸들러가 잠시 보관되는곳
- 태스크 큐 : 백그라운드에서 처리된 것이 등록되는 큐, 큐이니까 fifo방식으로 실행

console.log("시작")이 실행된다.  
setTimeout이 실행되어 id 반환후 종료된다.  
콜백 함수인 run은 백그라운드로 이동하고 타이머(3000ms)가 작동한다. 그와 동시에 console.log("끝")이 실행된다.  
타어미가 종료되면 run은 백그라운드에서 태스크 큐로 이동한다.  
'이벤트 루프'는 호출 스택이 비어있고 태스크 큐에 대기 중인 것이 있다면 호출 스택으로 옮기고 run은 이제 실행된다.  
만약 이때 호출 스택이 비어있지 않다면 태스크 큐에서 대기하게 되므로 콜백 함수는 상황에 따라서 설정한 타이머보다 늦게 실행될 수도 있다.  

#### 논 블로킹 I/O

파일 시스템 접근이나 네트워크 요청 등 I/O 작업은 동시에 처리할 수 있음.
아까 본 setTimeout이 논 블로킹으로 만드는 방식이다.

- 자바스크립트 코드는 동시에 실행 불가능 하다.
- 하지만 동시에 처리할 수 있는 작업들은 논-블로킹 방식으로 코드를 짜면 전체 소요 시간을 아낄 수 있다.
- 동시에 처리할 수 있는 작업이라도 논-블로킹 방식으로 코드를 짜지 않으면 효과를 볼 수 없다.
- 일반적인 js 코드는 논-블로킹 방식으로 짜도 '전체 소요 시간'에는 변화가 없지만 중간에 오래 걸리는 작업 때문에 다른 작업이 길게 대기하는 것을 막을 수 있다.

#### 싱글 스레드

노드는 직접 제어할 수 있는 스레드가 하나뿐이다. 한 번에 하나의 태스크만 처리가 가능하므로 블로킹을 최소화 하는 것이 중요하다.

### 장단점

위와 같은 논 블로킹, 싱글 스레드 방식으로 구동되기 때문에 많은 I/O 요청을 받아야 하는 경우 유리하나, cpu 연산이 많은 경우 불리하다.
(멀티 스레드 작업이 가능하기는 하나 느린 편이고 프로그래밍이 어렵다고 함)

웹 서버가 내장되어 있고 js를 사용해 json과의 호환이 잘 된다는 장점이 있다.
